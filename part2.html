<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style> 
        body {
  padding:20px;
}
* {
  box-sizing: border-box;
}
#block-contain { 
	display: flex;
	flex-flow: column wrap;
  max-width:100%;
}
.block {
  padding:20px;
  flex: 1 0 auto;
  overflow:hidden;
}
.inner {
  width: 100%;
  height: 100%;
  display: flex;
  flex: 1 0 auto;
  justify-content:center;
  align-items:center;
  font-size:3em;
  min-height:100px;
  border:1px solid black;
  background:Gainsboro;
}
    </style>
</head>
<body>
        <div id="block-contain">
                <div class="block" style="height:320px;">
                  <div class="inner">1</div>
                </div>
                <div class="block" style="height:430px;">
                  <div class="inner">2</div>
                </div>
                <div class="block" style="height:350px;">
                  <div class="inner">3</div>
                </div>
                <div class="block" style="height:280px;">
                  <div class="inner">4</div>
                </div>
                <div class="block" style="height:320px;">
                  <div class="inner">5</div>
                </div>
                <div class="block" style="height:310px;">
                  <div class="inner">6</div>
                </div>
                <div class="block" style="height:360px;">
                  <div class="inner">7</div>
                </div>
                <div class="block" style="height:270px;">
                  <div class="inner">8</div>
                </div>
                <div class="block" style="height:360px;">
                  <div class="inner">9</div>
                </div>
                <div class="block" style="height:420px;">
                  <div class="inner">10</div>
                </div>
                <div class="block" style="height:190px;">
                  <div class="inner">11</div>
                </div>
                <div class="block" style="height:270px;">
                  <div class="inner">12</div>
                </div>
        </div>
    <script>
if(window.innerWidth>1800){
  var COL_COUNT = 4;
}else if(window.innerWidth>800){
  var COL_COUNT = 3;
}else if(window.innerWidth>500){
  var COL_COUNT = 2;
}else if(window.innerWidth>400){
  var COL_COUNT =1;        
 }
console.log(window.innerwidth);
//var COL_COUNT = 3; // set this to however many columns you want
var col_heights = [], 
    container = document.getElementById('block-contain');
for (var i = 0; i <= COL_COUNT; i++) {
  col_heights.push(0);
}
for (var i = 0; i < container.children.length; i++) {
  var order = (i + 1) % COL_COUNT || COL_COUNT;
  container.children[i].style.order = order;
  col_heights[order] += parseFloat(container.children[i].style.height);
}
var highest = Math.max.apply(Math, col_heights);
container.style.height = highest+'px';
    </script>
</body>
</html>